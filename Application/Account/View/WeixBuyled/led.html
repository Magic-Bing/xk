<!DOCTYPE html>
<html>
    <head>
        <title><{$seo_title}></title>
        <meta name="keywords" content="LED销控表">
        <meta name="description" content="LED销控表">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta http-equiv="content-type" content="text/html; charset=utf-8">
        <meta name="apple-mobile-web-app-capable" content="yes">
        <link href="/Public/common/css/base.css" type="text/css" rel="stylesheet">
        <link href="/Public/xk/css/xk.css" type="text/css" rel="stylesheet">
        <link href="/Public/xk/css/led.css" type="text/css" rel="stylesheet">
        
         <!--<link href="/Public/xk/css/cj/style.css" type="text/css" rel="stylesheet">
         <link href="/Public/xk/css/cj/jquery.running.css" type="text/css" rel="stylesheet">-->

        <script src="/Public/common/js/jquery/jquery-1.11.3.min.js"></script>
        <script src="/Public/common/js/jquery/jquery-ui-1.12.0.custom/jquery-ui.js"></script>
        <script src="/Public/common/js/jquery/jquery.mousewheel.js"></script>
        <link href="/Public/common/js/jquery/perfect-scrollbar/perfect-scrollbar.css" type="text/css" rel="stylesheet">
        <script src="/Public/common/js/jquery/perfect-scrollbar/perfect-scrollbar.js"></script>
        <script src="/Public/common/js/layer/layer.js"></script>
        <script src="/Public/common/js/pc/functions.js"></script>
        <script src="/Public/common/js/functions.js"></script>
        
        <!--<script src="/Public/xk/js/cj/blower-loading.js"></script>
        <script src="/Public/xk/js/cj/jquery.running.js"></script>-->
        <script src="/Public/xk/js/cj/jquery.classyloader.min.js"></script>
       

        <script type="text/javascript">
            var room_url = {
                room_index: '/room/index.html',
                room_info: '/room/room_info.html',
                choose_room: '/room/choose_room.html',
                not_choose_room: '/room/not_choose_room.html',
                search_room: '/room/search_room.html',
                search_room_name: '/room/search_room_name.html',
                search_cst: '/room/search_cst.html',
                get_oneroom: '/room/get_oneroom.html',
            }
        </script>
        <style>
            video{  
                    position: fixed;
                    left: 50%;
                    top: 50%;
                    bottom: 0px;
                    min-width: 100%;
                    min-height: 100%;
                    height: auto;
                    width: auto;
                    transform: translateX(-50%) translateY(-50%); 
                /*加滤镜*/  
                /*-webkit-filter: grayscale(100%);*/  
                /*filter:grayscale(100%);*/  
            }  
            source{  
                min-width: 100%;  
                min-height: 100%;  
                height: auto;  
                width: auto;  
            }  
            #djs-type-title
            {
                font-size: 18px;
                font-weight: 500;
                margin-left: 10px
            }
            .djs-time
            {
                font-size: 18px;
                font-weight: 500;
                color: red;
            }
            
            .xsqhl{
                position: absolute;
                top: 5px;
                left: 50%;
                transform: translate(-40%, 0%);
                font-size: 18px;
                line-height: 45px;
            }
            .xsqhl span{
                margin-left: 15px;
                color:#FFF;
            }
            .td_floor1 {
            padding: 0 12px;
            width:45px;
            font-size: 90%;
            border: 1px solid #fff;
            color: #FFF;
            text-align: center;
            font-weight: bold;
        }
        #qhldc{
            position: absolute;
            bottom: 0;
            width: 30px;
            height:99%;
            background: #fef5fd;
            border-radius: 5px;
            top:20px
        }
        #qhlsc{
            position: absolute;
            bottom: 0;
            width: 30px;
            height: 0;
            background: #ec5858;
            border-radius: 5px;
        }
        #showtitle{
            position: absolute;
            bottom: -46px;
            width: 30px;
            line-height: 15px;
            color: #FFF;
            font-size: 14px;
            font-family: "Microsoft YaHei";
        }
        #showyszb{
            position: absolute;
            width: 30px;
            font-size: 14px;
            margin-left: 5px;
            line-height: 15px;
            text-align: center;
            color: #FFF;
        }
        #showprojtitle
        {
            font-size: 40px;
            color: #FFF;
            font-weight: 700;
            font-family: 宋体;
            line-height: 25px;
        }
        #cjtotaldiv{
            width: 100px;
            height:100px;
            line-height: 80px;
            background: red;
            border-radius: 50%;
            text-align: center;
            border:10px solid #FFF;
        }
        #wscountdiv{
                line-height: 105px;
                text-align: center;
                position: absolute;
                background: rgba(255, 255, 255, 0.75);
                width: 100px;
                height: 100px;
                border-radius: 50%;
        }
        .td_room{
                padding: 0;
        }
        #wscount{
            font-weight: bold;font-size: 20px; color: red;
        }
        .djs-ul{
            display: inline-block;width: 100%;text-align: center;
        }
        .djs-ul li{
            height: 45px;line-height: 45px;margin: -5px 0 0 -10px;color: #FFF;
        }
        /*#divtable{*/
            /*position: absolute;*/
            /*top: 50%;*/
            /*left: 50%;*/
            /*transform: translateX(-67%) translateY(-50%);*/
        /*}*/
        .divwxf {
            display:flex;
            align-items:center;
            justify-content:center;
            width: 100%;
            background-color: #fff;
            font-size: 90%;
            line-height:normal;
            height: 100%;
        }
        .divyxf {
            /*下面三句是让内容垂直居中 */
            display:flex;
            align-items:center;
            justify-content:center;

            width: 100%;
            line-height: normal;
            background-color: #ff0000;
            font-size: 90%;
            height: 100%;
        }
        .r_in {width:130px; height:130px; background: rgba(255, 255, 255, 0.75);border:5px solid #fef5fd; border-radius:50%; -webkit-border-radius:50%; -moz-border-radius:50%; -ms_border-radius:50%; overflow:hidden; position:relative;}
        .r_c {width:130px;  position:absolute; bottom:0; left:0; height:0;}
        .c1 {background:#2feeca;}
        .r_num {color:#ff0000;position:absolute; top:50%; margin-top:-30px; text-align:center; width:100%;}
        
        /*数字滚动插件的CSS可调整样式*/
        .mt-number-animate{ 
                font-family: 'FZYaoti' !important; 
                font-weight: bold;
                line-height:40px; 
                height: 40px;/*设置数字显示高度*/; 
                font-size: 20px;/*设置数字大小*/ 
                overflow: hidden; display: inline-block; position: relative; 
        }
        .mt-number-animate .mt-number-animate-dot{ 
                width: 14px;/*设置分割符宽度*/ 
                line-height: 40px; float: left; 
                text-align: center;
        }
        .mt-number-animate .mt-number-animate-dom{ 
                width: 12px;/*设置单个数字宽度*/ 
                text-align: center; float: left; position: relative; top: 0;
        }
        .mt-number-animate .mt-number-animate-dom .mt-number-animate-span{ width: 100%; float: left;font-family: 'FZYaoti' !important;}

            /*修改的样式*/
            body{
                position: absolute;
                width: 100%;
                height: 100%;
                background: #3e97eb;
            }
            #one_div{
                position: relative;
                width: 100%;
                height: 100%;
            }
            #roomdiv{
                width: calc(100% - 40px);
                height: calc(100% - 30px);
                position: relative;
                text-align: center;
                padding: 15px 20px;
            }
            #divtable{
                position: relative;
                width: 100%;
                height: 100%;
            }
            #divtable>table{
                border-collapse:separate;
                border-spacing:12px;
                height: 100%;
                width: 100%;
            }
            #divtable>table>tbody>tr>td>table{
                height: 100%;
                width: 100%;
            }

            /*#divtable>table>table>table{*/
                /*height: 100%;*/
                /*width: 100%;*/
            /*}*/

            table td{
                vertical-align:middle;
                text-align: center;
            }
            .w_tab>tbody>tr>td{
                vertical-align:top;
            }
            #divtable>table>tbody>tr>td>table>tbody>tr>td>table{
                height: 100%;
                border-collapse: collapse;
                border-spacing:2px;
               width: 100%;
            }
            #td_one{
                width: auto;
            }
            #td_two{
                width: 250px;
            }
            #list_right{
                position: relative;height:100%;margin-left:45px;bottom:8px;
            }
            #list_right_one{
                position:absolute;height:95%;bottom:44px;
                left:15px
            }
            .w_tab table{
                width: 100%;
                height: 100%;
            }
        </style>
    </head>
    <body >
        <div id="one_div">
            

            <!--<div id="loadingContainer">
                    <div class="loadingbar">
                            <div class="marker_container">
                                    <div class="marker"></div>
                                    <div class="marker"></div>
                                    <div class="marker"></div>
                                    <div class="marker"></div>
                            </div>
                            <div class="filler_wrapper">
                                    <div class="filler">
                                            <span class="value">0%</span>
                                    </div>
                            </div>
                    </div>
            </div>
            <button id="plus_ten" style="position: absolute;top: 10px;right: 10%;">点击增加 +10% </button>-->

            <div style="position:absolute;width:100%;height:auto;display: none;overflow: hidden;background:#32b0af;z-index: 888;" id="dsjdiv">
                <video >
                    <source src="../../../../Public/xk/img/djs.mp4" type="video/mp4">
                </video>
            </div>
            <!--<div id="bgzz" style="position:absolute;width:100%;height:100%;display: none;overflow: hidden;background:#000;z-index:888;opacity:0.6;" >
            </div>
            <div id="selloutdiv" style="display: none;width:400px;height:283px;position:absolute;top:50%;left:50%;transition: all 1.5s;transform: translate(-50%, -70%);z-index:889">
                <img src="../../../../Public/account/img/sx.png"  alt="售罄" />
            </div>-->
            <div id="roomdiv">
                <div id="divtable">
                    <div style="width:100%;height:45px;display:none;" >
                        <div style="display: block;">
                            <span class="a" id="djstemp"><{$time}></span>秒<span class="b"></span>
                            <span id="djstemp1" style="display:block;"><{$time1}></span>
                        </div>
                        <ul class="djs-ul">
                            <li>
                                <!--<span style=""><{$rooms[0]['projname']}></span><span> 微信开盘</span>-->
                                <span id="djs-type-title"> 
                                    <if condition="$iswks eq 1">
                                                离活动开始还有:
                                        <else/>
                                             <if condition="$iswks eq 0">
                                                 微信认购结束倒计时:
                                            <else/>
                                                 微信认购已结束:
                                            </if>
                                    </if>
                                </span>
                                <span class="bw djs-time" >0</span>小时
                                <span class="sw djs-time" >00</span>分
                                <span class="gw djs-time" >00</span>秒
                            </li>
                        </ul>
                    </div>
                    
                    <table id="roomstable">
                        <tr>
                        <volist name="builds" id="builds_vo" key="builds_k">
                            <td id="td_one">
                                <table>
                                    <tr>
                                    <volist name="units" id="units_vo" key="units_k">
                                        <if condition="$units_vo['bld_id'] eq $builds_vo['id']"> 
                                            <td style="padding-right:0">
                                                <table  class="w_tab">
                                                    <tr >
                                                        <td style="height: 20px">
                                                            <div style="width: calc(100% - 4px);margin-left: 1px;height:auto;text-align:center;border:1px solid #fff;color:#FFF;font-weight:bold;">
                                                                <{$builds_vo['buildname']}><{$units_vo.unit|default=1}>单元
                                                            </div>
                                                    </tr>
                                                    <tr >
                                                        <td>
                                                            <table  style="border-collapse: separate;border-spacing:1px;">
                                                                <volist name="floors" id="floors_vo" key="floors_k">
                                                                    <if condition="$floors_vo['bld_id'] eq $builds_vo['id']">																		
                                                                        <tr style="width:100%;"> 
                                                                            <td class="td_floor1">
                                                                                <{$floors_vo.floor|default=1}>F
                                                                            </td>
                                                                        <foreach name="nolist" item="nolist_vo">
                                                                            <if condition="$nolist_vo['bld_id'] eq $builds_vo['id']">
                                                                                <if condition="$nolist_vo['unit'] eq $units_vo['unit']">
                                                                                    <td class="td_room">
                                                                                    <php>$ii=0;</php>
                                                                                    <for start="$ii" end="count($rooms)">
                                                                                        <if condition="$rooms[$i]['bld_id'] eq $builds_vo['id']">	
                                                                                            <if condition="$rooms[$i]['unit'] eq $units_vo['unit']">
                                                                                                <if condition="$rooms[$i]['floor'] eq $floors_vo['floor']">
                                                                                                    <if condition="$rooms[$i]['no'] eq $nolist_vo['no']">
                                                                                                        <if condition="$rooms[$i]['is_xf'] eq 1">
                                                                                                            <div id="roomid_<{$rooms[$i]['id']}>" roomid="<{$rooms[$i]['id']}>" total="<{$rooms[$i]['total']}>" class="divyxf">
                                                                                                                <font style="font-size:90%;font-weight:bold"><{$rooms[$i].room}></font><br/>
                                                                                                            </div>
                                                                                                            <else />
                                                                                                            <div id="roomid_<{$rooms[$i]['id']}>" roomid="<{$rooms[$i]['id']}>" total="<{$rooms[$i]['total']}>" class="divwxf" >
                                                                                                                <font style="font-size:90%;font-weight:bold"><{$rooms[$i].room}></font><br/>
                                                                                                            </div>
                                                                                                        </if>
                                                                                                        <php>$ii++;break;</php>
                                                                                                    </if>
                                                                                                </if>
                                                                                            </if>
                                                                                        </if>
                                                                                    </for>
                                                                                    </td>
                                                                                </if>
                                                                            </if>
                                                                        </foreach>
                                                                        </td>
                                                                        </tr>
                                                                    </if>
                                                                </volist>	
                                                            </table>
                                                        </td>
                                                    </tr >
                                                </table>
                                            </td>
                                        </if>
                                    </volist>
                                    </tr>
                                </table>
                            </td>
                        </volist>
                        <td id="td_two">
                            <div style="position: relative;height: 100%;width: 100%;">
                                <div id="list_right_one" >
                                    <div id="showyszb" ><{$xsqhl}>%</div>
                                    <div id="qhldc" >
                                        <div id="qhlsc" ></div>
                                    </div>
                                    <div id="showtitle" >已售占比</div>
                                </div>
                                <div id="list_right" >
                                    <ul style="height: 100%;text-align: center;width:100%;">
                                        <li style="height:33%;display: flex;justify-content: center;align-items: center;">
                                            <div class="r_in">
                                                <div class="r_c c1"></div>
                                                <div class="r_num"><div class="numberRun"></div></div>
                                                <span style="position:absolute;margin-left: -50px;margin-top:70px;line-height: 40px;width: 100px;">成交额(万)</span>
                                             </div>
                                        </li>
                                        <li style="height:33%;display: flex;justify-content: center;align-items: center;">
                                            <div id="showprojtitle"><{$projinfo[0]['name']}><br/><span style="font-size:15px;">在线开盘</span></div>
                                            <!--<div id="showprojtitle"><img src="../../../../Uploads/hximg/log.png" alt="Smiley face" width="170" height="auto"><br/><span style="font-size:15px;">在线开盘</span></div>-->
                                        </li>
                                        <li style="height:33%;display: flex;justify-content: center;align-items: center;">
                                            <canvas class="loader"></canvas>
                                            <div id="wscountdiv"> 
                                                <div id="wscount"><div class="numberRun1"><{$wscount}></div></div>
                                                <span style="position: absolute;margin-left: -50px;margin-top: -40px;line-height: 15px;width: 100px;">可售套数</span>
                                            </div>
                                        </li>
                                    </ul>
                                </div>
                            </div>
                        </td>
                        </tr>
                    </table>
                    <div style="position:fixed;width:100%;text-align: center; color: #FFF; font-size: 14px;font-family:'Microsoft YaHei';font-weight: bold;bottom: 2px">Powered  by  云销控</div>
                </div>
            </div>
        </div>
        <script type="text/javascript">
//            var w_tab=$(".w_tab");
//            w_tab.css("width",100/w_tab.length+"%");
//            console.log(w_tab.length);
            var iswks="<{$iswks}>"; 
            var eventId = "<{$eventId}>";
            var roomcount = "<{$roomcount}>";
            var yscount = "<{$yscount}>";
            var wscount = "<{$wscount}>";
            var ycjtotal="<{$cjtotal}>";
            var isshowdjs=true;
            var xsqhl = 0.00;
            var zgd = 0;
            var jezgd = 0;
            var blower = null;
            var loader=null;
            var numRun=null;
            var isend=null;
            function launchFullscreen(element) {
            //                console.log(element);
                if(element.requestFullscreen) {
                    element.requestFullscreen();
                } else if(element.mozRequestFullScreen) {
                    element.mozRequestFullScreen();
                } else if(element.webkitRequestFullscreen) {
                    element.webkitRequestFullscreen();
                } else if(element.msRequestFullscreen) {
                    element.msRequestFullscreen();
                }
            }
            $(document).ready(function() {
                layer.confirm('是否全屏显示？', {
                    title:'温馨提示',
                    btn: ['确认','取消'] //按钮
                }, function(index){
                    layer.close(index);
                    launchFullscreen(document.documentElement);
                }, function(){
                });
                //调整TD的大小
                var tab=$(".w_tab table");
//                var t_height=1000;
                var tr_num=0;
                for(var i=0;i<tab.length;i++){
                    var tr=tab.eq(i).find("tr");
                    if(i===0){
                        tr_num=tr.length;
                    }else{
                        if(tr.length>tr_num){
                            tr_num=tr.length;
                        }
                    }
//                    var t_h=parseInt(tab.eq(i).find('tr').eq(0).find("td").eq(0).css('height'));
//                    if(t_h<t_height){
//                        t_height=t_h;
//                    }
                }
                for(var k=0;k<tab.length;k++){
                    var tr2=tab.eq(k).find("tr");
                    if(tr2.length<tr_num){
                        for(var s=0;s<(tr_num-tr2.length);s++){
                            tab.eq(k).find("tbody").append("<tr><td colspan='12' style='color: #3e97eb'>空</td></tr>")
                        }
                    }
                }
//                tab.find("td").css("height",t_height+"px");
//                console.log(tr_num);
                //调整表格大小
                //var dqbgheight=$("#roomstable").height();

                if (iswks==1){
                    $("#djs-type-title").text("离活动开始还有：")
                }
                else
                {
                    $("#djs-type-title").text("活动结束倒计时：")
                }
                xsqhl=(yscount/roomcount*100).toFixed(0);
                if(iswks>=0)
                {
                    var $djs=$("#djstemp").text();
                    showjsdjs($djs);
                }
                jezgd=parseInt($(".r_in").height())
                $(".c1").animate({
                    height: yscount/roomcount *jezgd
                },500);
                zgd=parseInt($("#qhldc").height())
                $("#qhlsc").animate({
                    height: yscount/roomcount * zgd
                },500);
                
                loader = $('.loader').ClassyLoader({
                    animate: false,
                    percentage: xsqhl,
                    showText:false,
                    lineWidth:20,
                    diameter:60,
                    remainingLineColor:'rgb(254, 245, 253)',
                    lineColor:'rgb(251, 173, 76)',
                    start:'top',
                    speed:1
                });  
                
                numRun = $(".numberRun").numberAnimate(
                    {
                        num:ycjtotal, 
                        dot:2, 
                        speed:600, 
                        symbol:","
                    }
                );
                numRun1 = $(".numberRun1").numberAnimate(
                    {
                        num:wscount, 
                        dot:0, 
                        speed:600, 
                        symbol:","
                    }
                );
            });
            
            //测试用
           /*$("#divtable").click(function () {
                if(isshowdjs)
                {
                    isshowdjs=false;
                    $("#dsjdiv").find("video").trigger("play");
                    $("#dsjdiv").show(); 
                    setTimeout(hidedjs, 10500);
                }
                else
                {
                    //shownewrooms();
                }
               
            });*/
            
            //获取最新数据
            function shownewrooms()
            {
                if (roomcount-yscount<=0)
                {
                    numRun1 = $(".numberRun1").numberAnimate(
                        {
                            num:'0', 
                            dot:0, 
                            speed:600, 
                            symbol:","
                        }
                    );
                    $("#bgzz").show();
                    $("#selloutdiv").show();
                    clearInterval(isend);
                }
                
                var $data = {
                    eventId: eventId
                };
                ajax_post_callback('/account/WeixBuyled/getAllOrderedRooms', $data, function (data, status) {
                    orderedRooms = data.info[1];
                    renderRoom(orderedRooms);
                });
                
                /*
                //测试
                var k=0;
                var orderedRooms=[];
                $wxf = $("#divtable").find(".divwxf");
                $yxf = $("#divtable").find(".divyxf");
                if ($wxf.length<=0)
                    return false;
                
                if ($yxf.length>0)
                {
                    k=$yxf.length;
                    for (var i = 0; i < $yxf.length; i++)
                    {   
                        orderedRooms[i] = $yxf.eq(i).attr("roomid");
                    }
                }

                var arrid = new Array();
                if ($wxf.length>0)
                {
                    for (var i = 0; i < $wxf.length; i++)
                    {
                        arrid[i] = $wxf.eq(i).attr("roomid");
                    }
                }
                var x= Math.floor((Math.random() * 50));
                if(x>$wxf.length)
                    x=$wxf.length;
                for (var i = 0; i < x; i++)
                {
                    var index = Math.floor((Math.random() * arrid.length));
                    orderedRooms[k]=arrid[index];
                   
                    k++;
                }
              
                renderRoom(orderedRooms);
                */
            }
            
            function renderRoom(rooms)
            {
                ycjtotal=0;
                //刷新房间状态
                var rooms1=rooms;
                for(var i = rooms.length-1; i >= 0; i--){
                    if(rooms[i]==0)
                    {
                        continue;
                    }
                    $("#roomid_" + rooms[i]).removeClass("divwxf").addClass("divyxf");
                    ycjtotal+=parseFloat($("#roomid_" + rooms[i]).attr("total"));
                    
                }
                yscount=rooms.length-1;
                
                xsqhl=(yscount/roomcount*100).toFixed(0);
                
                 //显示去化率
                $("#showyszb").text(xsqhl +"%");
                $("#qhlsc").animate({
                    height:yscount/roomcount * zgd
                },600);
                //显示成交金额
                numRun.resetData(parseFloat(ycjtotal/10000,2))
                 $(".c1").animate({
                        height: yscount/roomcount * jezgd
                },600);
                //显示待售房间数量
                //console.log(parseInt(roomcount)-parseInt(yscount));
                numRun1.resetData(parseInt(roomcount)-parseInt(yscount));
                loader.draw(xsqhl);
            }
            
            function hidedjs()
            {
                $("#dsjdiv").fadeOut(800);
                isend=setInterval("shownewrooms()",1000);
            }

            //显示时间倒计时
            function showjsdjs(times)
            {
                 var  interval = 1000,
                      nextTime=1000,
                      count = 0,
                      startTime = new Date().getTime(); 
                var ms=Math.floor(times / 1000);
                 $(".b").html(times);
                var gw = (Math.floor(ms%60) >9) ? Math.floor(ms%60): '0'+Math.floor(ms%60);//秒
                var sw = (Math.floor(ms/60%60) >=10) ? Math.floor(ms/60%60): '0'+ Math.floor(ms/60%60); //分
                var bw = Math.floor(ms/3600%60);//时
                $(".bw").text(bw);
                $(".sw").text(sw);
                $(".gw").text(gw);

                countTime = setInterval(function() {
                            count++;
                            if(count==60 && times>61000)
                            {
                                clearInterval(countTime);
                                geteventdjs();
                            return false;
                            }
                            //times = --times < 0 ? 0 : times;
                            times -= interval;
                            if (times<0) 
                                times=0;
                            ms = Math.floor(times / 1000);
                            if(times == 0) {
                                clearInterval(countTime);
                                if (iswks==1)
                                {
                                    var $djs=$("#djstemp1").text();
                                    iswks=2;
                                    showjsdjs($djs);
                                }
                                else if(iswks==3 || iswks==0)
                                {
                                    $(".begin-time").text("微信认购已结束...");
                                    $("#djs-type-title").text("微信认购已结束");
                                    $spanlist=$(".speedbuy-content").find(".wxrgbuy-button");
                                    if($spanlist && $spanlist.length>0)
                                    {
                                        for(var i=0;i<$spanlist.length;i++)
                                        {
                                            $spanlist.eq(i).removeClass("wxrgbuy-button").html("").text("结束");
                                        }
                                    }
                                }
                            }
                            else
                            {
                                if(iswks==1)
                                {
                                    if(times <= 11010 )
                                    {
                                        isshowdjs=false;
                                        $("#dsjdiv").find("video").trigger("play");
                                        $("#dsjdiv").show(); 
                                        setTimeout(hidedjs, 10500);
                                    }
                                }
                                if(iswks==2)
                                {
                                    $("#djs-type-title").text("微信认购结束倒计时").addClass("jxz");
                                    $(".djs-time").addClass("yks").removeClass("wks");
                                    $spanlist=$(".speedbuy-content").find(".buy-span");
                                    if($spanlist && $spanlist.length>0)
                                    {
                                        for(var i=0;i<$spanlist.length;i++)
                                        {
                                            if($spanlist.eq(i).text() == "认购")
                                                $spanlist.eq(i).addClass("wxrgbuy-button");
                                        }
                                    }
                                    iswks=3;
                                }
                            }   
                            //$(".a").html(ms);
                            //$(".b").html(hm);
                            var offset = new Date().getTime() - (startTime + count * interval);
                            nextTime = interval - offset;
                            gw = (Math.floor(ms%60) >9) ? Math.floor(ms%60): '0'+Math.floor(ms%60);//秒
                            sw = (Math.floor(ms/60%60) >=10) ? Math.floor(ms/60%60): '0'+ Math.floor(ms/60%60); //分
                            bw = Math.floor(ms/3600%60);//时
                            $(".bw").text(bw);
                            $(".sw").text(sw);
                            $(".gw").text(gw);
                            if (count>0 && (iswks==3 || iswks==0))
                            {
                               shownewrooms();
                            }
                    }, nextTime);
            }
           // 单独获取倒计时
            function geteventdjs(){
                var $data = {
                    id: eventId
                };
                var $url = "<{:U('/Account/WeixBuyled/geteventdjs')}>";
                ajax_post_callback($url, $data, function (data, status) {
                    if (data.status==1) {
                        var djsinfo = data.info[1];
                        iswks=djsinfo['iswks'];
alert(iswks);
                        $("#djstemp").text(djsinfo['time']);
                        $("#djstemp1").text(djsinfo['time1']);
                        showjsdjs(djsinfo['time']);
                    }else {

                    }
                })
            }

            function fmoney(s, n)  
            {  
               n = n > 0 && n <= 20 ? n : 2;  
               s = parseFloat((s + "").replace(/[^\d\.-]/g, "")).toFixed(n) + "";//更改这里n数也可确定要保留的小数位  
               var l = s.split(".")[0].split("").reverse(),  
               r = s.split(".")[1];  
               t = "";  
               for(i = 0; i < l.length; i++ )  
               {  
                  t += l[i] + ((i + 1) % 3 == 0 && (i + 1) != l.length ? "," : "");  
               }  
               return t.split("").reverse().join("") + "." + r.substring(0,2);//保留2位小数  如果要改动 把substring 最后一位数改动就可  
            }
            
            
            /**
            *  数字滚动插件 v1.0
            */
            ;(function($) {
              $.fn.numberAnimate = function(setting) {
                var defaults = {
                  speed : 1000,//动画速度
                  num : "", //初始化值
                  iniAnimate : true, //是否要初始化动画效果
                  symbol : '',//默认的分割符号，千，万，千万
                  dot : 0 //保留几位小数点
                }
                //如果setting为空，就取default的值
                var setting = $.extend(defaults, setting);

                //如果对象有多个，提示出错
                if($(this).length > 1){
                  alert("just only one obj!");
                  return;
                }

                //如果未设置初始化值。提示出错
                if(setting.num == ""){
                  alert("must set a num!");
                  return;
                }
                var nHtml = '<div class="mt-number-animate-dom" data-num="{{num}}">\
                        <span class="mt-number-animate-span">0</span>\
                        <span class="mt-number-animate-span">1</span>\
                        <span class="mt-number-animate-span">2</span>\
                        <span class="mt-number-animate-span">3</span>\
                        <span class="mt-number-animate-span">4</span>\
                        <span class="mt-number-animate-span">5</span>\
                        <span class="mt-number-animate-span">6</span>\
                        <span class="mt-number-animate-span">7</span>\
                        <span class="mt-number-animate-span">8</span>\
                        <span class="mt-number-animate-span">9</span>\
                        <span class="mt-number-animate-span">.</span>\
                      </div>';

                //数字处理
                var numToArr = function(num){
                  num = parseFloat(num).toFixed(setting.dot);
                  if(typeof(num) == 'number'){
                    var arrStr = num.toString().split("");  
                  }else{
                    var arrStr = num.split("");
                  }
                  //console.log(arrStr);
                  return arrStr;
                }

                //设置DOM symbol:分割符号
                var setNumDom = function(arrStr){
                  var shtml = '<div class="mt-number-animate">';
                  for(var i=0,len=arrStr.length; i<len; i++){
                    if(i != 0 && (len-i)%3 == 0 && setting.symbol != "" && arrStr[i]!="."){
                      shtml += '<div class="mt-number-animate-dot">'+setting.symbol+'</div>'+nHtml.replace("{{num}}",arrStr[i]);
                    }else{
                      shtml += nHtml.replace("{{num}}",arrStr[i]);
                    }
                  }
                  shtml += '</div>';
                  return shtml;
                }

                //执行动画
                var runAnimate = function($parent){
                  $parent.find(".mt-number-animate-dom").each(function() {
                    var num = $(this).attr("data-num");
                    num = (num=="."?10:num);
                    var spanHei = $(this).height()/11; //11为元素个数
                    var thisTop = -num*spanHei+"px";
                    if(thisTop != $(this).css("top")){
                      if(setting.iniAnimate){
                        //HTML5不支持
                        if(!window.applicationCache){
                          $(this).animate({
                            top : thisTop
                          }, setting.speed);
                        }else{
                          $(this).css({
                            'transform':'translateY('+thisTop+')',
                            '-ms-transform':'translateY('+thisTop+')',   /* IE 9 */
                            '-moz-transform':'translateY('+thisTop+')',  /* Firefox */
                            '-webkit-transform':'translateY('+thisTop+')', /* Safari 和 Chrome */
                            '-o-transform':'translateY('+thisTop+')',
                            '-ms-transition':setting.speed/1000+'s',
                            '-moz-transition':setting.speed/1000+'s',
                            '-webkit-transition':setting.speed/1000+'s',
                            '-o-transition':setting.speed/1000+'s',
                            'transition':setting.speed/1000+'s'
                          }); 
                        }
                      }else{
                        setting.iniAnimate = true;
                        $(this).css({
                          top : thisTop
                        });
                      }
                    }
                  });
                }

                //初始化
                var init = function($parent){
                  //初始化
                  $parent.html(setNumDom(numToArr(setting.num)));
                  runAnimate($parent);
                };

                //重置参数
                this.resetData = function(num){
                  var newArr = numToArr(num);
                  var $dom = $(this).find(".mt-number-animate-dom");
                  if($dom.length < newArr.length){
                    $(this).html(setNumDom(numToArr(num)));
                  }else if($dom.length == newArr.length){
                    $dom.each(function(index, el) {
                      $(this).attr("data-num",newArr[index]);
                    });
                  }
                  else if($dom.length > newArr.length)
                  {
                      $(this).html(setNumDom(numToArr(num)));
                  }
                  runAnimate($(this));
                };
                //init
                init($(this));
                
                return this;
              }
            })(jQuery);

        </script>
    </body>
</html>