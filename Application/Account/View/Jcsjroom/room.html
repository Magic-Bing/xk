<!DOCTYPE html>
<html lang="zh">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"> 
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>房间导入</title>
</head>
<body>
<extend name="Common/base" />
<block name="breadcrumb_active">
    <li><{$classify_name|default=''}></li>
	<li class="active"><{$seo_title|default=''}></li>
</block>
<block name="page_content">
<style type="text/css">
#tagscontent {
    border-top: none;
    height: auto;
    /* font-size: 12px; */
    color: #1B4670;
    text-align: left;
}

#tagscontent tr {
    line-height: 20px;
    height: auto;
    clear: both;
}

#tagscontent .table_td th, #tagscontent #sample-table-room th {
    background: #f2f2f2;
    text-align: center;
    font-size:13px;
    border: 1px solid #DDD;
}
#tagscontent th {
    color: #707070;
}

#tagscontent td {
    font-size: 13px;
    color: #1B4670;
    border: 1px solid #e8eef6;
}
.search {
    text-align: left;
    background: #fcf9f4;
    /*height: 38px;*/
    line-height: 38px;
    float:right;
    margin-right: 10px
}

.search_content {
    margin-top: 0px;
    color: #393939;
    padding-left: 20px;
    font-size:12px;
    background: #eff3f8;
}


/* 通用分页 */
.page-container {
	text-align: right;
	background: #eff3f8;
        padding-top: 12px;
        padding-bottom: 12px;
        border-bottom: 1px solid #DDD;
}
.page-container .num,
.page-container .prev,
.page-container .next,
.page-container .first,
.page-container .end,
.page-container .rows,
.page-container .current
{
	padding: 5px;
	display: inline-block;
        padding: 6px 12px;
        background: #fafafa;
        color: #0076cf;
        font-size: 12px;
        border: 1px solid #ddd;
        margin-left: -1px;
}
.page-container .current
{
    background: #6faed9;
    color: #fff;
    font-weight: bold;
    cursor: pointer;
}
.page-container .num:hover,
.page-container .prev:hover,
.page-container .next:hover,
.page-container .first:hover,
.page-container .end:hover,
.page-container .rows:hover,
.page-container .current:hover
{
    cursor: pointer;
}
form{
    display: inline;
}

.button {
    /* background: url('__IMG__/buttom_bg.gif') right bottom no-repeat; */
    height: 24px;
    line-height: 18px;
    cursor: pointer;
    text-align: center;
    padding: 2px 10px;
    border: 1px solid #c4d9e9;
    background: #ffffff;
    color: #1f74bd;
    overflow: hidden;
    margin-left: 20px;
    font-size:12px;
}
.showtop_t {
    font-weight: bold;
    text-align: left;
    color: #0086ae;
    padding-left: 20px;
    padding-top: 5px;
}
.show_content_m_t2 {
    width: 100%;
    border-left: 1px solid #fff;
    border-right: 1px solid #fff;
    background-color: #fff;
}

.select_page {
    width: 400px;
    margin-left: 20px;
    float: left;
}
a:link {
    color: #0076cf;
    text-decoration: none;
   /*font-weight:bold;*/
}


.delurl {
    background: url('__IMG__/buttom_bg.gif') right bottom no-repeat;
    line-height: 22px;
    cursor: pointer;
    text-align: center;
    padding: 5px 10px;
    border: 1px solid #c4d9e9;
    color: #395366;
    overflow: hidden;
    margin-left: 20px;
    font-size: 14px;
}

.xzblddiv{
width: 60px;
margin-left: 40px;
color:#FFF;
border:1px solid #FFF;
background:rgb(220, 45, 14);
border-radius:5px;
padding:2px 0;
font-weight:bold;
cursor:pointer;
line-height:20px
}
a{
cursor:pointer;
}

.row-fluid
{
position:absolute;
width:260px;
height:300px;
background:blue;
margin-left:400px;
margin-top:100px;
}

/* 房间列表 */
.room-title-project {
	font-size: 13px;
	font-weight: bold;
}

.room-nav-edit {
	clear: both;
	margin: 0;
	padding: 0;
}
.room-nav-edit .room-nav-edit-btn {
	    list-style: none;
            display: inline-block;
            padding: 4px 7px;
            background: #428bca;
}
.room-export-btn {
	width:66px;
	color:#FFF;
	font-size: 13px;
}
.room-export-btn:link {
	color:#FFF;
}
.room-export-icon-in {
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
	display: inline-block;
	background: url(__IMG__/dr01.png) no-repeat scroll 0 2px/14px 14px;
	width: 15px;
	height: 15px;
}
.room-export-icon-out {
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
	display: inline-block;
	background: url(__IMG__/dr01.png) no-repeat scroll 0 2px/14px 14px;
	width: 15px;
	height: 15px;
}
.room-export-icon-refresh {
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
	display: inline-block;
	background: url(__IMG__/sx01.png) no-repeat scroll 0 2px/18px 15px;
	width: 20px;
	height: 17px;
}
.room-project {
	/*padding-top: 10px;
	margin: 5px 0;*/
	background: #f5f5f5;
	border-left: 2px solid #e4d7c1;
}
.a_tb_bg{
    width: 20px;
    background: #D45C36;
    padding: 3px 5px;
    margin-left: 5px;
}

#sample-table-room>tbody>tr:nth-child(odd)>td{
    background-color: #f9f9f9;
}
.search_content label input{
    width:100px;
    padding: 3px 4px;
}
.pagerow{
    padding-top: 12px;
    padding-bottom: 12px;
    background-color: #eff3f8;
    border-bottom: 1px solid #DDD;
}
</style>
<div class="row">
    <div class="col-xs-12">
    <div class="table-header">
	<span>房间列表</span>
        
	
	<div style="float:right;margin-right:10px;height: 31px;">

	</div>
</div>

<div class="show_content_m_t2">
 <div style="width:100%;overflow-x:hidden;overflow-y:hidden"> 
     <div style="background: #eff3f8;height: 43px;">   
     <div style="display:block;float:left;line-height: 38px;">
         <form method="post" id="selectproj" name="selectproj" action="room" >
            <font style="margin-left:10px;">项目</font>
            <select id= "projlist" name="projid" style="height:25px;padding: 1px 10px;" >
                    <option value="0" selected>全部</option>
                     <foreach name="projlist" item="projlist_vo">
                         <if condition="$projid eq $projlist_vo['id']">
                             <option value="<{$projlist_vo['id']}>" selected>
                                 <{$projlist_vo['company_name']}>--<{$projlist_vo['name']}>
                             </option>
                             <else />
                             <option value="<{$projlist_vo['id']}>">
                                 <{$projlist_vo['company_name']}>--<{$projlist_vo['name']}>
                             </option>
                         </if>
                    </foreach>
            </select>
            </form>
        </div>
	<div class="search"> 
		<div class="search_content">	 
			<form method="post"  action="room" id="form-b">
				<input type="hidden" name="projid" value="<{$projid|default=''}>" style="display:none;">
                <input type="hidden" name="p" value="<{$p|default=1}>">
                <input type="hidden" name="r" value="<{$listRows|default=15}>">
                <input type="hidden" name="excel" value="0">
				<label style="font-size: 13px;">
				   楼栋
				   <input type="text" name="buildname" value="<{$buildname|default=''}>"> 
				</label>
			   
			   &nbsp;
				<label>
					单元
					<input type="text" name="unit" value="<{$unit|default=''}>"> 
				</label>
				&nbsp;
				<label>
					户型
					<input type="text" name="hx" value="<{$hx|default=''}>">  
				</label>
               
				&nbsp;
				<label style="font-size: 13px;">
					房号
					<input type="text" name="room" value="<{$room|default=''}>">    
				</label>
				
				<input type="submit" value="提交查询" class="button room-search-button">  
			</form>
		</div>
	</div>
     </div>
	
    <div class="tags" style="width:100%; padding: 0;border:0;">
      	<div id="tagstitle"></div>
        <div id="tagscontent">
           <div id="con_one_1">
             <div class="table_td" >
              <!--<form method="post" action="">-->
                  <table border="0" cellspacing="2" id="sample-table-room" cellpadding="4" class="table table-striped table-bordered table-hover dataTable" >
                    <thead>
                      <tr>
                        <th width="60px">
                            <label>
                                <input type="checkbox" class="ace">
                                <span class="lbl"></span>
                            </label>
                        </th>
						<th align="center">序号</th>
						<th align="center">房间名称</th>
						<th align="center">户型</th>
						<th align="center">建筑面积</th>
                        <th align="center">建筑单价</th>
						<th align="center">套内面积</th> 
						<th align="center">套内单价</th>
						<th align="center">标准总价</th>
						<th align="center">优惠后总价</th>
						<th align="center">销售状态</th>
                        <th align="center" style="width:100px">
						操作
						</th>
                      </tr>
                    </thead> 
                     <tbody id="roomlisttb">
                      <foreach name="roomlist" item="roomlist_vo" key="k">
                      <tr class="s_out" onmouseover="this.bgColor='#F5F5F5';" onmouseout="this.bgColor='ffffff';" bgcolor="#ffffff"> 
                        <td align="center" >
                            <label>
                                <input type="checkbox"  data-id="<{$roomlist_vo['id']}>"  <if condition="$roomlist_vo['is_xf'] eq 1"> class="ace" disabled<else/>class="ace delete-bs"</if>>
                                <span class="lbl"></span>
                            </label>
                        </td>
                          <td class="center"><{:($p-1)*$listRows+$k+1}></td>
						<td align="left">
                                                    <a href="<{:U('jcsjroom/edit', array('id' => $roomlist_vo['id']))}>" style="text-decoration: underline;">
                                                            <{$roomlist_vo['projname']}>-<{$roomlist_vo['buildname']}>-<{$roomlist_vo['unit']}>-<{$roomlist_vo['room']}>
                                                    </a>
						</td> 
                        <td align="center"><{$roomlist_vo['hx']}></td> 
                        <td align="right"> <{$roomlist_vo['area']}> </td> 
                        <td align="right"><{:number_format($roomlist_vo['price'],2)}></td> 
						<td align="right"> <{$roomlist_vo['tnarea']}> </td> 
                        <td align="right"><{:number_format($roomlist_vo['tnprice'],2)}></td>
						<td align="right"><{:number_format($roomlist_vo['total'],2)}></td> 
						<td align="right"><{:number_format($roomlist_vo['discount'],2)}></td>
						<if condition="$roomlist_vo['is_xf'] eq 0">
						<td align="center">待售</td>	
						<else/>
						<td align="center">已售</td>	
						</if>
                        <td align="center">
                        	<a href="<{:U('jcsjroom/edit', array('id' => $roomlist_vo['id']))}>" >
                                                            <span class="" style="padding: 3px 3px;background-color: #6fb3e0;color: #FFF;" title="修改">
								<i class="icon-edit bigger-120"></i>
                                                            </span>
							</a>
                            <if condition="$roomlist_vo['is_xf'] eq 0">
							<a href="javascript:void(0);" class="a_tb_bg js-del-room" roomid="<{$roomlist_vo['id']}>" title="删除">
                                                            <span class="white">
								<i class="icon-trash bigger-120"></i> 
                                                            </span>
                                                        </a>
                                <else/>
                                &nbsp;
                                &nbsp;
                                &nbsp;
                                &nbsp;
                            </if>
                        </td> 
                      </tr> 
                       </foreach> 
                     <tr>
                        <td class="center">
                            <div class="action-buttons" id="delete-batch" title="批量删除" style="border-style: none">
                                <a>
                                <i class="icon-trash bigger-130" style="margin: 0;color:#dd5a43;"></i>
                                </a>
                            </div>
                        </td>
                        <td colspan="10">
                        <ul class="room-nav-edit" >
                                <li class="room-nav-edit-btn">
                                        <a class="room-export-btn js-room-excel-import" href="javascript:void(0);">
                                                <i class="icon-cloud-upload bigger-110"></i>
                                                导入数据
                                        </a>
                                </li>
                                <li class="room-nav-edit-btn">
                                    <a class="room-export-btn excel-out" href="/Account/Jcsjroom/exportfj/projid/<{$projid}>.html">
                                                <i class="icon-cloud-download bigger-110"></i>
                                                导出房间模板
                                        </a>
                                </li>
                                 <li class="room-nav-edit-btn">
                                        <a class="room-export-btn excel-out" href="/Account/Jcsjroom/exportcw/projid/<{$projid}>.html">
                                                <i class="icon-cloud-download bigger-110"></i>
                                                导出车位模板
                                        </a>
                                </li>
                            <li class="room-nav-edit-btn" style="float: right;
    margin-right: 18px;">
                                <a class="room-export-btn" id="check-room" href="javascript:;">
                                    <i class="icon-cloud-download bigger-110"></i>
                                    导出房间数据
                                </a>
                            </li>
                        </ul>
                        </td>     
                     </tr>
                    </tbody> 

                  </table>
                <div class="row pagerow">
                    <div class="col-sm-6">
                            <div class="dataTables_info" id="sample-table-2_info">
                            &nbsp;&nbsp;第 <input id="newpage" type="tel" value="<{$p|default=1}>" style="width:30px" class="tzpage"> 页/ <{$total_pages|default=1}> 页，每页<input id="newrows"  type="tel" value="<{$listRows|default=15}>" style="width:30px"  class="tzrows"> 条/共 <{$count|default=1}> 条
                            </div>
                    </div> 
                    <div class="col-sm-6">
                            <div class="dataTables_paginate paging_bootstrap"> 
                                    <{$page_show|default=''}>
                            </div>
                    </div>
		</div>
				
            </div>
           </div>
        </div>
    </div>    
  </div> 
</div>
 
</div>
</div>
<div class="js-choose-user-excel-import-tpl" style="display:none;">
	<form method="post" id="choose-user-excel-import-tpl-form" class="choose-user-excel-import-tpl-form" name="import-form" action="<{:U('upload')}>" enctype="multipart/form-data" >
		<div class="choose-user-excel-import-tpl">
			<div class="choose-user-excel-import-tpl-title">
				提交EXECL数据文件
			</div>
			<div class="choose-user-excel-import-tpl-input">
				<input type="file" class="choose-excel-import-tpl-file upload" name="excel" value="" />
			</div>
			<div class="choose-user-excel-import-tpl-btns center">
				<button class="btn btn-sm btn-purple js-choose-room-excel-import-tpl-btn">
					<i class="icon-cloud-upload align-top bigger-110"></i>
					导入数据
				</button>
			</div>
		</div>
	</form>
</div>

</block>
<block name="page_js">
<script type="text/javascript">
    var c_num="<{$p}>";
$(function() {
    $(document).on("click",".excel-out",function () {
        if($("#projlist").val() === '0'){
            layer_alert("请选择一个项目！");
            return false;
        }
    });
    //批量删除
    $("#delete-batch").on("click",function () {
        var cd=$(".delete-bs:checked");
        var id_arr=[];
       for(var i=0;i<cd.length;i++){
           id_arr[i]=cd.eq(i).attr("data-id");
       }
       if(id_arr.length===0){
           gritter_alert('请至少选中一条数据！');
           return false;
       }
       var data={"sz":id_arr};
        var callback = function() {
            ajax_post_callback("<{:U('/Account/Jcsjroom/delete_batch')}>", data, function(data, status) {
                console.log(data);
                if (data['status'] != 1) {
                    gritter_alert(data['info']);
                    return false;
                } else {
                    gritter_alert_success('删除成功！');

                    setTimeout(function() {
                       window.location.reload();
                    }, 1000);
                }
            });
        };
        layer_confirm('确认删除吗，删除后将不能恢复？', callback);

    });
    $("#form-b input").on("keyup",function () {
       if(event.keyCode ===13){
           $("#form-b input[name='p']").val("1");
           $("#form-b").submit();
       }
    });
    $("#check-room").on("click",function () {
        $("#form-b input[name='excel']").val("1");
        $("#form-b").submit();
    });
    $("#projlist").change(function(){
            $("#selectproj").submit();
      });  

      $(".js-del-room").on('click', function(){
          var $id=$(this).attr("roomid");
          if ($id==0)
            {
                    layer_alert("数据异常，请稍后重试");
                    return false;
            }
            var callback = function() {
			var $url = Jcsj_room_url.delroom;			
			var $data = {
				id: $id,
			}
			ajax_post_callback($url, $data, function(data, status) {
				if (data['status'] != 1) {
					gritter_alert(data['info']);
					return false;
				} else {
					gritter_alert_success('删除成功！');
					
					window.location.reload();
				}			
			});
		}
		
		layer_confirm('是否删除此房间？！', callback);
      });	
	
        //房间 - 导入excel - 提示
	$(".js-room-excel-import").on('click', function() {
		var $html = $(".js-choose-user-excel-import-tpl").html();
		
		layer_html($html);
		
		return false;
	});

    //分页跳转
    $(".pagination li").on("click",function () {
        var tx=$(this).attr("data-tx");
        if(tx !==undefined){
            if(tx ==="上一页"){
                $("#form-b input[name='p']").val(Number(c_num)-1);
            }else if(tx ==="下一页"){
                $("#form-b input[name='p']").val(Number(c_num)+1);
            }else if(tx ==="首页"){
                $("#form-b input[name='p']").val(1);
            } else if(tx ==="尾页"){
                $("#form-b input[name='p']").val("<{$total_pages|default=1}>");
            }else{
                $("#form-b input[name='p']").val(tx);
            }
            $("#form-b").submit();
        }
    });
    //全选和全不选
    $("#sample-table-room input:first").click(function () {
        if($(this).prop("checked")===true){
            $("#sample-table-room .delete-bs").prop("checked",true);
        }else{
            $("#sample-table-room .delete-bs").prop("checked",false);
        }
    });


    //设置每页显示条数
    $(".tzrows").keypress(function(e) {
        if (e.which == 13)
        {
            $zcount=parseInt("<{$count}>",10);//总条数
            $oldcount=parseInt("<{$listRows}>",10);//旧的的显示条数
            $newcount=parseInt($("#newrows").val(),10);//新的显示条数
            if($newcount<=$zcount &&$newcount>0)
            {
                $("#form-b input[name='r']").val($newcount);
                $("#form-b input[name='p']").val("1");
                $("#form-b").submit();
            }
        }
    });

    //直接跳转到第N页
    $(".tzpage").keypress(function(e) {
        if (e.which == 13)
        {
            $zpage=parseInt("<{$total_pages}>",10);
            $newpage=parseInt($("#newpage").val(),10);
            //$dqpage=parseInt($(".pagination .current a").text(),10);
            $dqpage=parseInt("<{$p}>",10);
            if($dqpage != $newpage && $newpage<=$zpage &&$newpage>0)
            {
                $("#form-b input[name='p']").val($newpage);
                $("#form-b").submit();
//                     var $count=0;
//                     $oldhref=window.location.href.replace("http://",'');
//                     if ($oldhref.indexOf("/p/")>-1)
//                     {
//                        if ($dqpage>0 && $dqpage<10)
//                        {
//                            $count=4;
//                        }
//                        else
//                        {
//                            $count=5;
//                        }
//                        $bthstr=$oldhref.substr($oldhref.indexOf("/p/"),$count);
//                        window.location.href="http://"+ $oldhref.replace($bthstr,'/p/'+$newpage);
//                     }
//                     else
//                     {
//                          window.location.href="http://"+ $oldhref.replace(".html",'/p/'+$newpage+".html");
//                     }
            }
        }


    });
});
function checkall()
            { 
                    var $checkinfo = $('#chkall').is(':checked');
                    if($checkinfo ==  true){
                            $("input[name='id[]']").prop("checked",true); 
                    }else{
                            $("input[name='id[]']").prop("checked",false); 
                    } 
            }
            
</script>
</block>
</body>
</html>